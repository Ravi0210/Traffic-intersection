Lots of code but stil not functional :( 
